<?xml version="1.0" encoding="GB2312" ?>
<SQLTEST>
	<CONTENT> -BACKUP_90001-BUG507194 </CONTENT>
	<!--
		测试点列表
		1.错误的备份路径对备份的影响;(完成)
		2.备份路径中\/对备份的影响;(完成)
	-->
	<!--
		修改记录列表
		序号	修改类型	修改内容									修改人	修改日期
		1		创建		创建文件并完成测试用例						丁飞	2008-8-27	
	-->
	<TestPointBegin>测试点1：错误的备份路径对备份的影响 </TestPointBegin>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
		<SQL>CREATE DATABASE DB01_BACKUP_90001 DATAFILE 'DB01_BACKUP_90001.DBF' SIZE 64;</SQL>
		<SQL>CREATE TABLE SYSDBA.T01_BACKUP_90001 AT DB01_BACKUP_90001 (C1 INT,C2 VARCHAR(1024));</SQL>
		<SQL>INSERT INTO DB01_BACKUP_90001.SYSDBA.T01_BACKUP_90001 VALUES (1,'DB01_BACKUP_90001.SYSDBA.T01_BACKUP_90001');</SQL>
	</SQL_CASE>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
		<SQL>CREATE OR REPLACE FUNCTION SF01_BACKUP_90001 RETURN VARCHAR(1024)
			AS 
			SYS_DATA_PATH VARCHAR(1024);
			DATA_PATH VARCHAR(1024);
			BEGIN
				SELECT PATH INTO SYS_DATA_PATH FROM SYSFILES WHERE DBID=0 AND GROUP_ID=0 AND ID=0;
				PRINT SYS_DATA_PATH;
				DATA_PATH:=LEFT(SYS_DATA_PATH,INSTR(UCASE(SYS_DATA_PATH),'SYSTEM.DBF')-2);
				PRINT DATA_PATH;
				RETURN DATA_PATH;
			END;
		</SQL>
	</SQL_CASE>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
		<SQL>CREATE OR REPLACE FUNCTION SF02_BACKUP_90001 RETURN VARCHAR(1024)
			AS 
			SYS_DATA_PATH VARCHAR(1024);
			PATH_CHAR VARCHAR(1024);
			BEGIN
				SELECT PATH INTO SYS_DATA_PATH FROM SYSFILES WHERE DBID=0 AND GROUP_ID=0 AND ID=0;
				PRINT SYS_DATA_PATH;
				PATH_CHAR:=SUBSTR(SYS_DATA_PATH,INSTR(UCASE(SYS_DATA_PATH),'SYSTEM.DBF')-1,1);
				PRINT PATH_CHAR;
				RETURN PATH_CHAR;
			END;
		</SQL>
	</SQL_CASE>
	<SQL_CASE>
		<SQLSTR></SQLSTR>
		<SQLSTR>FromSql:SELECT SF01_BACKUP_90001</SQLSTR>
	</SQL_CASE>
	<SQL_CASE>
		<SQLSTR1></SQLSTR1>
		<SQLSTR1>FromSql:SELECT SF02_BACKUP_90001</SQLSTR1>
		<SMES> '@SQLSTR1'我的测试用的 </SMES>
	</SQL_CASE>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_FAIL</TYPE>
		<SQL>BACKUP DATABASE DB01_BACKUP_90001 FULL TO DB01_BACKUP_90001_BAK1 BAKFILE '@SQLSTR@SQLSTR1ERRORPATH@SQLSTR1DB01_BACKUP_90001_BAK1.bak';</SQL>
	</SQL_CASE>
	
	<TestPointBegin>测试点2：备份路径中\/对备份的影响 </TestPointBegin>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
		<SQL>CREATE OR REPLACE FUNCTION SF03_BACKUP_90001 RETURN VARCHAR(1024)
			AS 
			SYS_DATA_PATH VARCHAR(1024);
			PATH_CHAR VARCHAR(1024);
			REPATH_CHAR VARCHAR(1024);
			BEGIN
				SELECT PATH INTO SYS_DATA_PATH FROM SYSFILES WHERE DBID=0 AND GROUP_ID=0 AND ID=0;
				PRINT SYS_DATA_PATH;
				PATH_CHAR:=SUBSTR(SYS_DATA_PATH,INSTR(UCASE(SYS_DATA_PATH),'SYSTEM.DBF')-1,1);
				PRINT PATH_CHAR;
				IF (PATH_CHAR='/')
				THEN REPATH_CHAR:='\'; 
				ELSE REPATH_CHAR:='/'; 
				END IF;
				RETURN REPATH_CHAR;
			END;
		</SQL>
	</SQL_CASE>
	<SQL_CASE>
		<SQLSTR2></SQLSTR2>
		<SQLSTR2>FromSql:SELECT SF03_BACKUP_90001</SQLSTR2>
	</SQL_CASE>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_FAIL</TYPE>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '';</SQL>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '@SQLSTR@SQLSTR1ERRORPATH';</SQL>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '@SQLSTR@SQLSTR1ERRORPATH@SQLSTR1';</SQL>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '@SQLSTR@SQLSTR1ERRORPATH@SQLSTR2';</SQL>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '@SQLSTR@SQLSTR1@SQLSTR1ERRORPATH';</SQL>
		<SQL>ALTER DATABASE DB01_BACKUP_90001 MODIFY BACKUPDIR TO '@SQLSTR@SQLSTR1@SQLSTR2ERRORPATH';</SQL>
	</SQL_CASE>
	<SQL_CASE>
		<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
		<SQL>BACKUP DATABASE DB01_BACKUP_90001 FULL TO DB01_BACKUP_90001_BAK2 BAKFILE 'DB01_BACKUP_90001_BAK2.bak';</SQL>
	</SQL_CASE>
	
	<!--  测试用例清除快，该关键字标识清除块开始。如果上面某条语句执行出错后，程序会自动跳到这块来做环境清除工作 --> 
	<CLEAR>
		<UID>SYSDBA</UID>
		<PWD>SYSDBA</PWD>
		<DATABASE>SYSTEM</DATABASE>
		<RECONNECT></RECONNECT>
		<SQL_CASE>
			<TYPE>DIRECT_EXECUTE_SUCCESS</TYPE>
			<SQL>DROP FUNCTION SF01_BACKUP_90001;</SQL>
			<SQL>DROP FUNCTION SF02_BACKUP_90001;</SQL>
			<SQL>DROP FUNCTION SF03_BACKUP_90001;</SQL>
			<SQL>DROP DATABASE DB01_BACKUP_90001 CASCADE;</SQL>
		</SQL_CASE>
	</CLEAR>
</SQLTEST>